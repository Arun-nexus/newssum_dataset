<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TIME AWARE SUMMARIZER</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

    <div class="bg"></div>

    <div class="container">
        <h1>TIME AWARE SUMMARIZER</h1>
        <p class="tagline">time-aware indian news intelligence</p>

        <div class="card">
            <label>year</label>
            <input id="yr" type="number" placeholder="e.g. 2013">

            <label>question</label>
            <textarea id="q" rows="4" placeholder="what happened during the allahabad stampede?"></textarea>

            <button id="btn">generate answer</button>

            <div class="loader hidden" id="loader">thinking...</div>
        </div>

        <div class="output" id="out">
            <p class="hint">response will appear here</p>
        </div>
    </div>

    <script>
        const btn = document.getElementById('btn');
        const out = document.getElementById('out');
        const loader = document.getElementById('loader');

        btn.onclick = async () => {
            const year = document.getElementById('yr').value;
            const question = document.getElementById('q').value;

            if (!year || !question) {
                alert("Please fill both year and question");
                return;
            }

            loader.classList.remove('hidden');
            out.innerHTML = '<p class="hint">Generating answer...</p>';

            try {
                const response = await fetch(`/generate?year=${year}&question=${encodeURIComponent(question)}`, {
                    method: 'POST'
                });

                const data = await response.json();

                out.innerText = data.answer;

            } catch (error) {
                out.innerText = "Error: cannot connect with the server.";
                console.error(error);
            } finally {
                loader.classList.add('hidden');
            }
        };
    </script>
</body>
</html>